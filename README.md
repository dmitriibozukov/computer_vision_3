# CV Lab 3 — Классификация погодных условий по изображениям с использованием CNN

Лабораторная работа №3 по предмету "Компьютерное зрение"

**Цель работы:** Научиться создавать простые системы классификации изображений на основе сверточных нейронных сетей.

![i](https://github.com/user-attachments/assets/5a716418-0439-4638-a238-bab3f3f4ede1)


## 1. Теоретическая база

Сверточные нейронные сети (Convolutional Neural Networks, CNN) — класс нейронных сетей, специально разработанный для обработки данных с сеточной структурой, таких как изображения. Основные компоненты CNN:

- **Сверточные слои:** извлекают локальные признаки (края, текстуры, формы) с помощью фильтров.
- **Пулинговые слои:** уменьшают размерность карт признаков, сохраняя важную информацию.
- **Полносвязные слои:** выполняют финальную классификацию на основе извлеченных признаков.

В данной работе CNN используется для мультиклассовой классификации изображений погодных условий.

---

## 2. Описание разработанной системы

### 2.1. Датасет
Был использован датасет для классификации погодных условий. Данные разделены на:
- **Тренировочный набор (`train/`)** – для обучения модели.
- **Тестовый набор (`test/`)** – собран вручную, содержит не менее 50 изображений.

Классы включают различные погодные явления, такие как: `dew`, `fogsmog`, `frost`, `glaze`, `hail`, `lightning`, `rain`, `rainbow`, `rime`, `sandstorm`, `snow`.

### 2.2. Предобработка данных
- Изменение размера изображений до `224x224`.
- Разделение данных на тренировочную и валидационную выборки (80/20).
- **Аугментация данных** для балансировки классов:
  - Горизонтальное отражение.
  - Случайный поворот на 15 градусов.
  - Применялась только к классам с малым количеством примеров.

### 2.3. Архитектура CNN

class model(nn.Module):
    def __init__(self, num_classes=11, pool_out=7):
        super().__init__()
        self.conv1 = nn.Conv2d(3, 16, 3, padding=1)
        self.conv2 = nn.Conv2d(16, 32, 3, padding=1)
        self.conv3 = nn.Conv2d(32, 48, 3, padding=1)
        self.gap = nn.AdaptiveAvgPool2d((pool_out, pool_out))
        self.fc1 = nn.Linear(48 * pool_out * pool_out, 128)
        self.fc2 = nn.Linear(128, num_classes)

## 3. Результаты и выводы

### 3.1. Метрики обучения
- **Optimizer:** Adam (lr=0.001)
- **Loss function:** CrossEntropyLoss
- **Epochs:** 10
- **Batch size:** 64
- **Environment:** Google Colab (PyTorch + GPU)

После обучения модель показала следующие результаты на валидационной выборке:
- **Val Accuracy:** 
- **Val Loss:** 


### 3.3. Выводы
1. Модель успешно обучена классификации 11 классов погодных условий.
2. Использование аугментации помогло сбалансировать миноритарные классы.
3. Архитектура с тремя сверточными слоями показала достаточную эффективность для данной задачи.
4. Модель не переобучилась — loss на валидации стабильно снижался.        
